#!/bin/bash
set -euo pipefail

# Get the templates path from plugin config or use default
TEMPLATES="${BUILDKITE_PLUGIN_CFN_LINT_TEMPLATES:-template.yaml}"

echo "--- :cloudformation: Running cfn-lint on ${TEMPLATES}"

# Run the Docker container with the specified templates
# The path is passed as is, letting cfn-lint handle the glob pattern
docker run --rm -v "$(pwd):/data" giammbo/cfn-lint "/data/${TEMPLATES}"
